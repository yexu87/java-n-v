name: Build Java Jar

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4       # 顺便升级到 v4

    - name: Set up JDK 11
      uses: actions/setup-java@v4     # 顺便升级到 v4
      with:
        java-version: '11'
        distribution: 'temurin'

    - name: Compile Java
      run: |
        mkdir -p target
        javac -d target src/main/java/App.java
        echo "Main-Class: App" > manifest.txt
        cd target
        jar cvfm ../app.jar ../manifest.txt *.class

    - name: Upload Jar
      uses: actions/upload-artifact@v4  # 关键修复：改为 v4
      with:
        name: app-jar
        path: app.jar
